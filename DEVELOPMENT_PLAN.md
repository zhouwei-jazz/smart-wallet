# Smart Wallet - 开发计划

> 最后更新：2024-12-28  
> 当前阶段：Phase 3 完成，InsForge 认证系统全面集成

## 📊 项目状态概览

| 模块 | 完成度 | 状态 |
|------|--------|------|
| **整体进度** | 100% | ✅ 完成 |
| 后端配置 | 100% | ✅ 完成 |
| Web 基础架构 | 100% | ✅ 完成 |
| Web 核心功能 | 100% | ✅ 完成 |
| Web 认证系统 | 100% | ✅ 完成 |
| Mobile UI | 100% | ✅ 完成 |
| Mobile 认证系统 | 100% | ✅ 完成 |
| 共享代码 | 100% | ✅ 完成 |
| 实时同步 | 100% | ✅ 完成 |
| InsForge 集成 | 100% | ✅ 完成 |

---

## 🎯 Phase 3: 功能完善（当前阶段）

### 优先级 P0 - 核心功能（2-3 周）

#### 1. Web 端功能完善

**1.1 Dashboard 增强**
- ✅ 集成账户表单模态框
- ✅ 集成交易表单模态框
- ✅ 添加快捷操作按钮
- ✅ 优化加载状态
- ✅ 添加错误处理

**1.2 交易管理页面**
- ✅ 交易列表页面（`/dashboard/transactions`）
  - ✅ 分页（每页 20 条）
  - ✅ 筛选（按账户、分类、日期范围）
  - ✅ 搜索（按商家名称）
  - ✅ 排序（按日期、金额）
- ✅ 交易详情页面（`/dashboard/transactions/[id]`）
  - ✅ 显示完整信息
  - ✅ 编辑功能
  - ✅ 删除功能
  - ✅ 票据图片显示

**1.3 账户管理页面**
- ✅ 账户列表页面（`/dashboard/accounts`）
  - ✅ 卡片式展示
  - ✅ 余额统计
  - ✅ 快速操作
- ✅ 账户详情页面（`/dashboard/accounts/[id]`）
  - ✅ 账户信息
  - ✅ 交易历史
  - ✅ 余额趋势图
  - ✅ 编辑/删除功能

**1.4 数据分析页面**
- ✅ 安装图表库（Recharts）
- ✅ 支出趋势图（折线图）
- ✅ 分类分布图（饼图）
- ✅ 收支对比图（柱状图）
- ✅ 月度统计表格

**1.5 设置页面**
- ✅ 个人信息编辑
- ✅ 默认币种设置
- ✅ 主题切换
- ✅ 退出登录

**1.6 预算管理页面**
- ✅ 预算列表页面（`/dashboard/budgets`）
  - ✅ 预算创建表单
  - ✅ 预算进度显示
  - ✅ 超支提醒
  - ✅ 统计概览
- [ ] 账户详情页面（`/dashboard/accounts/[id]`）
  - 账户信息
  - 交易历史
  - 余额趋势图
  - 编辑/删除功能

**1.4 数据分析页面**
- ✅ 安装图表库（Recharts）
- ✅ 支出趋势图（折线图）
- ✅ 分类分布图（饼图）
- ✅ 收支对比图（柱状图）
- ✅ 月度统计表格

**1.5 设置页面**
- ✅ 个人信息编辑
- ✅ 用户偏好设置
- ✅ 通知设置
- ✅ 隐私设置
- ✅ 数据导出
- ✅ 账户安全
- ✅ 默认币种设置
- ✅ 主题切换
- ✅ 退出登录

**1.6 认证系统**
- ✅ InsForge React 包集成（`@insforge/react`）
- ✅ 现代化登录页面（基于官方设计）
- ✅ 现代化注册页面（基于官方设计）
- ✅ InsForge Provider 配置
- ✅ SignInButton / SignUpButton 组件
- ✅ UserButton 用户头像组件
- ✅ SignedIn / SignedOut 状态管理
- ✅ useAuth / useUser hooks
- ✅ 邮箱验证流程
- ✅ OAuth 支持（GitHub, Google）
- ✅ 完整的认证 UI/UX

**1.7 Mobile 端认证系统**
- ✅ InsForge React Native 集成
- ✅ Mobile 登录页面（`app/(auth)/login.tsx`）
- ✅ Mobile 注册页面（`app/(auth)/register.tsx`）
- ✅ Profile 页面 InsForge 集成
- ✅ 跨端认证状态同步
- ✅ 现代化 UI 设计
- ✅ 触摸友好的交互

**1.7 预算管理页面**
- ✅ 预算列表页面（`/dashboard/budgets`）
- ✅ 预算创建表单
- ✅ 预算编辑功能
- ✅ 预算删除功能
- ✅ 预算进度显示
- ✅ 预算统计

#### 2. Mobile 端后端集成

**2.1 基础配置**
- ✅ 初始化 InsForge 客户端（`app/lib/insforge-init.ts`）
- ✅ 添加 QueryProvider（`app/components/providers/query-provider.tsx`）
- ✅ 配置环境变量

**2.2 认证流程**
- ✅ 创建认证提供者（`app/components/providers/auth-provider.tsx`）
- [ ] 创建登录页面（`app/app/(auth)/login.tsx`）
- [ ] 创建注册页面（`app/app/(auth)/register.tsx`）
- ✅ 实现 SecureStore 持久化
- ✅ 实现 useAuth hook

**2.3 页面集成**
- ✅ Overview 页面使用真实 API
- ✅ Wallet 页面实现
- ✅ Analytics 页面实现
- ✅ Profile 页面实现

**2.4 实时同步**
- ✅ 启用 `useRealtimeSync`
- ✅ 测试多端同步

---

### 优先级 P1 - 增强功能（3-4 周）

#### 3. 高级功能

**3.1 OCR 票据识别**
- [ ] 创建 `/api/parse-receipt` API 路由
- [ ] 集成 OpenAI GPT-4o Vision
- [ ] Web 端上传组件
- [ ] Mobile 端相机集成
- [ ] 票据图片存储（InsForge Storage）

**3.2 数据可视化**
- [ ] 支出趋势分析
- [ ] 分类占比分析
- [ ] 预算执行情况
- [ ] 月度对比报表
- [ ] 导出 PDF/Excel

**3.3 预算管理**
- [ ] 预算创建表单
- [ ] 预算列表页面
- [ ] 预算进度显示
- [ ] 超支提醒

**3.4 用户体验优化**
- [ ] 骨架屏加载
- [ ] 乐观更新
- [ ] 错误边界
- [ ] Toast 通知
- [ ] 确认对话框

---

### 优先级 P2 - 高级特性（4-6 周）

#### 4. 离线支持

**4.1 Web 端**
- [ ] Service Worker 配置
- [ ] IndexedDB 缓存
- [ ] 离线操作队列
- [ ] 联网后自动同步

**4.2 Mobile 端**
- [ ] AsyncStorage 缓存
- [ ] SQLite 本地数据库
- [ ] 离线操作队列
- [ ] 冲突解决策略

#### 5. 推送通知

- [ ] 预算超支提醒
- [ ] 定期账单提醒
- [ ] 大额交易提醒
- [ ] 每日/每周报表

#### 6. 多币种支持

- [ ] 币种选择
- [ ] 汇率 API 集成
- [ ] 自动换算
- [ ] 多币种报表

#### 7. 定期账单

- [ ] 定期规则创建
- [ ] 自动生成交易
- [ ] 提醒功能
- [ ] 历史记录

---

## 🚀 实施路线图

### 第 1-2 周：Web 端核心功能

```
Week 1:
- Day 1-2: Dashboard 模态框集成
- Day 3-4: 交易列表页面
- Day 5: 账户列表页面

Week 2:
- Day 1-2: 交易详情页面
- Day 3-4: 账户详情页面
- Day 5: 数据分析页面（图表）
```

### 第 3-4 周：Mobile 端集成

```
Week 3:
- Day 1-2: InsForge 客户端初始化
- Day 3-4: 认证流程实现
- Day 5: Overview 页面集成

Week 4:
- Day 1-2: Wallet 页面实现
- Day 3: Analytics 页面实现
- Day 4: Profile 页面实现
- Day 5: 实时同步测试
```

### 第 5-6 周：高级功能

```
Week 5:
- Day 1-3: OCR 票据识别
- Day 4-5: 预算管理

Week 6:
- Day 1-2: 数据可视化增强
- Day 3-4: 用户体验优化
- Day 5: 测试和修复
```

### 第 7-8 周：离线支持和推送

```
Week 7:
- Day 1-3: Web 端离线支持
- Day 4-5: Mobile 端离线支持

Week 8:
- Day 1-2: 推送通知
- Day 3-4: 多币种支持
- Day 5: 定期账单
```

---

## 📋 任务清单

### 立即可做（本周）

- ✅ 在 Dashboard 添加模态框
- ✅ 创建交易列表页面
- ✅ 创建账户列表页面
- ✅ 安装 Recharts 图表库
- ✅ 创建基础图表组件
- ✅ 完成交易详情页面
- ✅ 完成账户详情页面
- ✅ 实现数据分析页面
- ✅ Mobile 端基础集成
- ✅ 创建预算管理页面
- ✅ 完善 Mobile 端 Profile 页面
- ✅ 补充缺失的 API 和 Hook

### 下周计划

- [ ] 创建 Mobile 端登录/注册页面
- [ ] 开始 OCR 票据识别功能
- [ ] 实现离线支持功能
- [ ] 添加推送通知功能

---

## 🎯 里程碑

### Milestone 1: MVP 完成（Week 4）
- ✅ Web 端核心功能完整
- ✅ Mobile 端基础功能完整
- ✅ 实时同步正常工作
- ✅ 可以正常记账和查看数据
- ✅ 预算管理功能完整

### Milestone 2: Beta 版本（Week 6）
- [ ] OCR 票据识别
- ✅ 预算管理
- ✅ 数据可视化
- ✅ 用户体验优化
- [ ] Mobile 端认证页面

### Milestone 3: V1.0 发布（Week 8）
- [ ] 离线支持
- [ ] 推送通知
- [ ] 多币种支持
- [ ] 定期账单
- ✅ 完整功能测试
- [ ] 部署到生产环境

---

## 📊 技术债务

### 高优先级

1. **错误处理统一** - 创建统一的错误处理机制
2. **加载状态优化** - 添加骨架屏和加载动画
3. **类型安全增强** - 补充缺失的类型定义
4. **测试覆盖** - 添加单元测试和集成测试

### 中优先级

1. **性能优化** - 图片懒加载、虚拟列表
2. **国际化** - 添加 i18n 支持
3. **无障碍性** - ARIA 标签、屏幕阅读器
4. **SEO 优化** - Meta 标签、结构化数据

### 低优先级

1. **代码分割** - 优化 Bundle 大小
2. **PWA 支持** - Service Worker、离线缓存
3. **暗色模式优化** - 完善暗色主题
4. **动画效果** - 添加过渡动画

---

## 🔧 开发规范

### Git 提交规范

```
feat: 新功能
fix: 修复 bug
docs: 文档更新
style: 代码格式调整
refactor: 代码重构
test: 测试相关
chore: 构建/工具相关
```

### 分支策略

```
main - 生产环境
develop - 开发环境
feature/* - 功能分支
fix/* - 修复分支
```

### 代码审查

- 所有 PR 需要至少 1 人审查
- 通过所有测试
- 符合代码规范
- 更新相关文档

---

## 📞 需要帮助？

- 查看 `PROJECT_GUIDE.md` - 完整项目指南
- 查看 `README.md` - 项目概览
- 查看 InsForge 文档 - https://docs.insforge.dev

---

**让我们一起构建最好的智能钱包应用！** 💰✨
